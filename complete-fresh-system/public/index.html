<!DOCTYPE html>
<html>
<head>
    <title>Fresh Deployed System</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        .upload-area { border: 2px dashed #ccc; padding: 40px; text-align: center; margin: 20px 0; }
        button { padding: 10px 20px; margin: 10px; background: #007cba; color: white; border: none; cursor: pointer; }
        .status { margin: 20px 0; padding: 10px; background: #f0f0f0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Fresh Deployed System</h1>
        <p>This is the exact deployed version - simple and working</p>
        
        <div class="upload-area">
            <input type="file" id="fileInput" accept=".pdf,.svg,.png,.jpg" />
            <p>Upload logo files</p>
        </div>
        
        <button onclick="createProject()">Create Project</button>
        <button onclick="generatePDF()" disabled id="pdfBtn">Generate PDF</button>
        
        <div id="status" class="status">Ready</div>
    </div>

    <script>
        let currentProject = null;
        let uploadedLogos = [];

        async function createProject() {
            try {
                const response = await fetch('/api/projects', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name: 'Simple Project', templateSize: 'A3' })
                });
                currentProject = await response.json();
                document.getElementById('status').textContent = `Project created: ${currentProject.id}`;
                document.getElementById('pdfBtn').disabled = false;
            } catch (error) {
                document.getElementById('status').textContent = `Error: ${error.message}`;
            }
        }

        async function generatePDF() {
            if (!currentProject) return;
            
            try {
                const response = await fetch(`/api/projects/${currentProject.id}/generate-pdf`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ garmentColor: '#FFFFFF' })
                });
                
                if (response.ok) {
                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'simple-output.pdf';
                    a.click();
                    document.getElementById('status').textContent = `PDF generated: ${blob.size} bytes`;
                } else {
                    document.getElementById('status').textContent = 'PDF generation failed';
                }
            } catch (error) {
                document.getElementById('status').textContent = `Error: ${error.message}`;
            }
        }

        // File upload handler
        document.getElementById('fileInput').addEventListener('change', async function(e) {
            if (!currentProject || !e.target.files[0]) return;
            
            const formData = new FormData();
            formData.append('files', e.target.files[0]);
            
            try {
                const response = await fetch(`/api/projects/${currentProject.id}/logos`, {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
                document.getElementById('status').textContent = `Logo uploaded: ${result.length} files`;
            } catch (error) {
                document.getElementById('status').textContent = `Upload error: ${error.message}`;
            }
        });
    </script>
</body>
</html>
